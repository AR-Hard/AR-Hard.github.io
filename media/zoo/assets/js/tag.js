/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

!function(i){function o(){}i.extend(o.prototype,{name:"BrowseTags",options:{msgSave:"Save",msgCancel:"Cancel"},initialize:function(t,e){this.options=i.extend({},this.options,e);var n=this;(this.input=t).find("span.edit-tag a").bind("click",function(){var t=i(this);n.removePanel(),t.hide();var e=i("<span>").addClass("edit-tag-panel").insertAfter(t);i('<input class="text" type="text" name="new">').val(t.text()).appendTo(e).focus().bind("keydown",function(t){13==t.which&&(t.stopPropagation(),n.submit()),27==t.which&&(t.stopPropagation(),n.removePanel())}),i('<input type="hidden" name="old">').val(t.text()).appendTo(e),i("<button>").addClass("save").text(n.options.msgSave).appendTo(e).bind("click",function(){n.submit()}),i("<a>").addClass("cancel").text(n.options.msgCancel).appendTo(e).bind("click",function(){n.removePanel()})})},removePanel:function(){this.input.find("span.edit-tag-panel").each(function(){i(this).parent().find("a").show(),i(this).remove()})},submit:function(){this.input.find('input[name="task"]').val("update"),this.input.submit()}}),i.fn[o.prototype.name]=function(){var n=arguments,a=n[0]?n[0]:null;return this.each(function(){var t=i(this);if(o.prototype[a]&&t.data(o.prototype.name)&&"initialize"!=a)t.data(o.prototype.name)[a].apply(t.data(o.prototype.name),Array.prototype.slice.call(n,1));else if(!a||i.isPlainObject(a)){var e=new o;o.prototype.initialize&&e.initialize.apply(e,i.merge([t],n)),t.data(o.prototype.name,e)}else i.error("Method "+a+" does not exist on jQuery."+o.name)})}}(jQuery),function(s){function i(){}s.extend(i.prototype,{name:"Tag",options:{url:"",addButtonText:"Add Tag"},initialize:function(t,e){this.options=s.extend({},this.options,e);var o,n=this,p={};this.tagArea=t,this.tagInput=t.find('input[type="text"]'),this.tagInput.autosuggest(s.extend({allowDuplicates:!1,inputName:"tags[]",prefill:this.tagInput.val()!=this.tagInput.attr("placeholder")?this.tagInput.val():"",source:function(t,a){var i=t.term;i in p?a(p[i]):o=s.getJSON(n.options.url,{tag:i},function(t,e,n){p[i]=t,n===o&&a(t)})}},this.options)).bind("keydown",function(t){switch(t.which){case 13:t.preventDefault(),n.tagInput.autosuggest("addItem",n.tagInput.val())}}).placeholder(),t.delegate("div.tag-cloud a","click",function(){n.tagInput.autosuggest("addItem",s(this).text()),n.tagInput.trigger("blur.placeholder")})}}),s.fn[i.prototype.name]=function(){var n=arguments,a=n[0]?n[0]:null;return this.each(function(){var t=s(this);if(i.prototype[a]&&t.data(i.prototype.name)&&"initialize"!=a)t.data(i.prototype.name)[a].apply(t.data(i.prototype.name),Array.prototype.slice.call(n,1));else if(!a||s.isPlainObject(a)){var e=new i;i.prototype.initialize&&e.initialize.apply(e,s.merge([t],n)),t.data(i.prototype.name,e)}else s.error("Method "+a+" does not exist on jQuery."+i.name)})}}(jQuery);