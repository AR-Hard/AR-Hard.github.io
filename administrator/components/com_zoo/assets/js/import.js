/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

!function(a){function o(){}o.prototype=a.extend(o.prototype,{name:"ImportExport",options:{msgImportWarning:"Please choose a file first!"},initialize:function(i,t){this.options=a.extend({},this.options,t);var n=this;i.find("div.uploadbox").each(function(){var t=a(this).find("input.filename");a(this).find('input[name^="import-"]').bind("change",function(){t.val(this.value)}),a(this).find("button.upload").bind("click",function(){""==t.val()?alert(n.options.msgImportWarning):submitbutton("import")})}),i.find("a.exporter-link").each(function(){var t=a(this);t.bind("click",function(){i.find('input[name="exporter"]').val(t.attr("id")),submitbutton("importfrom")})}),i.find("button.export").bind("click",function(){var t=i.find('input[name="format"]');t.val("raw"),i.find('input[name="exporter"]').val("zoo2"),submitbutton(a(this).data("task")),t.val("html")})}}),a.fn[o.prototype.name]=function(){var n=arguments,e=n[0]?n[0]:null;return this.each(function(){var t=a(this);if(o.prototype[e]&&t.data(o.prototype.name)&&"initialize"!=e)t.data(o.prototype.name)[e].apply(t.data(o.prototype.name),Array.prototype.slice.call(n,1));else if(!e||a.isPlainObject(e)){var i=new o;o.prototype.initialize&&i.initialize.apply(i,a.merge([t],n)),t.data(o.prototype.name,i)}else a.error("Method "+e+" does not exist on jQuery."+o.name)})}}(jQuery),function(a){function o(){}o.prototype=a.extend(o.prototype,{name:"Import",options:{msgSelectWarning:"You didn't assign all item types. Items of these types will not be imported. Do you want to proceed anyway?",msgWarningDuplicate:"There are duplicate assignments.",msgNameWarning:"Please choose a name column.",task:"doimport"},initialize:function(t,i){this.options=a.extend({},this.options,i);var n=this;(this.form=t).find("fieldset.frontpage, fieldset.categories").each(function(){var t=a(this);t.find('input[name^="import-"]').bind("change",function(){a(this).is(":checked")?t.find("div.assign-group").show():t.find("div.assign-group").hide()})}),t.find("fieldset.items").each(function(){var i=a(this);i.find("select.type").bind("change",function(){var t=a(this),n=new RegExp("\\["+t.val()+"\\]$");i.find("li.assign select.assign").each(function(){var t=a(this);if(t.attr("name").match(n)){var i=t.nextAll(".name").text().trim();t.show().find("option").each(function(){a(this).text().replace(/\(.*\)/i,"").trim()==i&&t.val(a(this).val())})}else t.hide()})})}),a("#submit-button").bind("click",function(){"doimportcsv"!=n.options.task&&n.hasDuplicateSelectedAssignments()?alert(n.options.msgWarningDuplicate):"doimportcsv"!=n.options.task||n.hasNameAssigned()?n.hasUnassignedTypes()&&!confirm(n.options.msgSelectWarning)||submitbutton(n.options.task):alert(n.options.msgNameWarning)})},hasNameAssigned:function(){var i=!1;return this.form.find("div.assign-group").each(function(){var t=new RegExp("\\["+a(this).find("select.type").val()+"\\]$");a(this).find("select.assign").each(function(){a(this).attr("name").match(t)&&"_name"==a(this).val()&&(i=!0)})}),i},hasUnassignedTypes:function(){var t=!1;return this.form.find("select.type").each(function(){""!=a(this).val()||(t=!0)}),t},hasDuplicateSelectedAssignments:function(){var n=!1;return this.form.find("div.assign-group").each(function(){var t=a(this).find("select.assign");for(i=0;i<t.length;i++)for(j=i+1;j<t.length;j++)if(value_a=a(t.get(i)).val(),value_b=a(t.get(j)).val(),""!=value_a&&"_category"!=value_a&&value_a==value_b)return void(n=!0)}),n}}),a.fn[o.prototype.name]=function(){var n=arguments,e=n[0]?n[0]:null;return this.each(function(){var t=a(this);if(o.prototype[e]&&t.data(o.prototype.name)&&"initialize"!=e)t.data(o.prototype.name)[e].apply(t.data(o.prototype.name),Array.prototype.slice.call(n,1));else if(!e||a.isPlainObject(e)){var i=new o;o.prototype.initialize&&i.initialize.apply(i,a.merge([t],n)),t.data(o.prototype.name,i)}else a.error("Method "+e+" does not exist on jQuery."+o.name)})}}(jQuery);